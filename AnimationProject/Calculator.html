<html class="fullscreen">
<head>
<title>Game!</title>    
</head>
<style>
    /*html, body,canvas {
      width:  100%;
      height: 100%;
      margin: 0px;
    }*/
    fullscreen,body,html{
        width:  100%;
        height: 100%;
        margin: 0px;    
    }

    .rectangle{
        position: absolute;
        box-sizing: content-box; 
        background-color:hsl(191,0%,93%);
        top:10%;
        left:30%;
        width: 50%;
        height: 50%;
           
        border: 2px solid grey;
    }
    
    .myProgress {
      width: 100%;
      background-color: white;
    }

    .myBar {
        width: 100%;
        height: 10%;
        background-color: blue;
        text-align: center;
        
        color: white;  
    }
    .number{
        position: relative;
        width:10%,
        height: 10%;
    }

</style>
<body>
    <h1 id="level"></h1>
    <h2 id="feedback"></h2>
    <div class="rectangle">
        
            <div class="myProgress" ><div class="myBar" id="myBar">cdscs</div></div>
            <h1 id="question" style="position:relative;left:35%;">2+2?</h1>
            <div>
            <button class="number" value=9 onclick="PutNumber(this.value)">9</button><button class="number" value=8 onclick="PutNumber(this.value)">8</button><button class="number" value=7 onclick="PutNumber(this.value)">7</button><button class="number" value="-" onclick="Negative()">-</button>
            </div>
            ><button class="number" value=6 onclick="PutNumber(this.value)">6</button><button class="number" value=5 onclick="PutNumber(this.value)">5</button><button class="number" value=4 onclick="PutNumber(this.value)">4</button><button class="number"  onclick="Clear()">CE</button>
            <button class="number" value=3 onclick="PutNumber(this.value)">3</button><button class="number" value=2 onclick="PutNumber(this.value)">2</button><button class="number" value=1 onclick="PutNumber(this.value)">1</button><button class="number" value=0 onclick="PutNumber(this.value)">0</button>
            <input style="position:relative;width:100%;height:20%;" id="answer" type="number" >
            <button id="submit_answer" style="position:relative;width:100%;height:22%;" onclick="Check()">Submit</button>
               
    </div>   
    

</body>
<script>
    var negative=false;
    function PutNumber(number){
        if(negative){
            document.getElementById("answer").value+=-number;
            negative=false;
        }
        else{
            
            document.getElementById("answer").value+=number;
        }
    }
    function Clear(){
        document.getElementById("answer").value="";
    }
    function Negative(){
        negative=true;
    }
    
    function move(limit) {
        var time=limit;
        var dt=10;//miliseconds
        var elem = document.getElementById("myBar");   
        var width = 100;
        var id = setInterval(frame, dt);
        function frame() {
            if (width <= 0) {
                clearInterval(id);
                Check();
            } else {
                time-=dt;
                width=Math.round((time/limit)*100);
                if(time<=1000*60){
                    elem.innerHTML=Math.round(time/(1000))+"s";
                }else{
                    elem.innerHTML=Math.floor((time/(1000))/60)+"min"+" "+Math.round(time/(1000))+"s";
                }
                elem.style.width = width + '%'; 
            }
        }
        
    }
    move(1000*10)//*60*1);
    function Check(){
        console.log("answer:"+document.getElementById("answer").value)
        if(result==document.getElementById("answer").value){
            document.getElementById("feedback").innerHTML="<font color='green'>You Found the Right Answer!</font>"
        }else{
            document.getElementById("feedback").innerHTML="<font color='red'>Wrong Answer!</font>"
        }
    }
    var result=0;
    function Main(){
        
        var input = document.getElementById("answer");

        // Execute a function when the user releases a key on the keyboard
        input.addEventListener("keyup", function(event) {
          // Cancel the default action, if needed
          event.preventDefault();
          // Number 13 is the "Enter" key on the keyboard
          if (event.keyCode === 13) {
            // Trigger the button element with a click
            document.getElementById("submit_answer").click();
          }
        });
        
        
        var lv1max=10,lv1min=-1,lv2max=20,lv2min=-10,lv3max=100,lv3min=-100;
        var random_level=Math.floor(Math.random()*3);
        random_level=0;
        //var numbers=[];
        var operations=['+','-','*','/'];//0->+;1->-;2->x;3->/;
        var equation=[];
        var equation_op=[];
        var equation_num=[];
        var out="";
        
        if(random_level==0){
            document.getElementById("level").innerHTML="Lv1";
            var number_of_operations=1+Math.floor(Math.random()*3);
            for (i=0;i<=number_of_operations;i++){
                var num1=Math.floor(Math.random()*(lv1max-lv1min)+lv1min);
                //var num2=Math.floor(Math.random()*(lv1max-lv1min)+lv1min);
                if(num1<0){
                    equation_num.push(num1);
                    equation.push("("+num1+")");
                }
                else{
                    equation_num.push(num1);
                   equation.push(num1); 
                }
                
                if(i<number_of_operations){
                    var random_operation=operations[Math.floor(Math.random()*2)];//just sum and subtraction
                    equation.push(random_operation);
                    equation_op.push(random_operation);
                }
            }
            for(i=0;i<equation.length;i++){
                out+=equation[i];
                
            }
            var next_operation=[];
            for(i=0,j=0;i<equation.length;i++){
                
                //is a number
                if(equation[i]!='+' && equation[i]!='-' &&equation[i]!='*' && equation[i]!='/'){
                    var op=next_operation.pop();
                    if(i==0){
                        result+=equation_num[i];
                    }else{
                        if(op=='+'){
                            result+=equation_num[j];   
                        }
                        if(op=='-'){
                            result-=equation_num[j];
                        }
                        if(op=='*'){
                            result*=equation_num[j];
                        }
                        if(op=='/'){
                            result/=equation_num[j];
                        }
                    }
                    j++;
                }
                else{//operation
                    next_operation.push(equation[i]);
                }
                
            }
            console.log("result:"+result);
            document.getElementById("question").innerHTML=out+"?";
        }
        if(random_level==1){
            document.getElementById("level").innerHTML="Lv2";
            
        }
        if(random_level==2){
            document.getElementById("level").innerHTML="Lv3";
            
        }
        
        
    }
    window.onload=Main();
</script>
</html>
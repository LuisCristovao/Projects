<html class="fullscreen">
<head>
<title>Game!</title>    
</head>
<style>
/*html, body,canvas {
  width:  100%;
  height: 100%;
  margin: 0px;
}*/
fullscreen,body,html{
    width:  100%;
    height: 100%;
    margin: 0px;    
}

.fullscreen .btn{
    position: absolute;     
}
.fullscreen .text{
        position: absolute;
}    

</style>
<body>
<canvas   id="canvas"  onmousemove="MousePos(event)"  > </canvas>
    
<button class="btn" id="one_player" style="top:40%;left:45%;width:10%;height:10%;">One Player</button>
<button class="btn" id="two_players" style="top:60%;left:45%;width:10%;height:10%;">Two Players</button>
<h1 class="text" style="top:30%;left:45%;width:10%;height:10%;"><font color="white"></font></h1>    
</body>
<script>
    var canvas=document.getElementById("canvas");
    var context=canvas.getContext("2d");  
    var mouse=[0,0];//x and y
    
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
    canvas.addEventListener("touchmove",TouchMove,false);

    var GoodAttacks=[];
    var GoodDefense=[];
    var GoodEvolve=[];
    var EvilAttacks=[];
    var EvilDefense=[];
    var EvilEvolve=[];
    var Intro=[];
    var Idle=[];
    var actualAnimationRunning;
    var menu;
    var startTime;
    var time=0;
    var dt;
    class Menu{
        
        constructor(){
            this.Buttons={};
            this.Buttons["OnePlayer"]=document.getElementById("one_player");
            this.Buttons["TwoPlayers"]=document.getElementById("two_players");
            
            this.Buttons["OnePlayer"].addEventListener("click",this.OnePlayer,false);
            
        }
        
        
        
        OnePlayer(){
            
            HideButtons();
            time=0
            actualAnimationRunning=Idle[0];
            
        }
       
    }
    
    
    function HideButtons(){
            
            for(key in menu.Buttons){
                var value = menu.Buttons[key];
                /* use key/value for intended purpose */
                value.style.visibility="hidden";
            }
    }
    
    function readTextFile(file)
    {
        var rawFile = new XMLHttpRequest();
        rawFile.open("GET", file, false);
        rawFile.onreadystatechange = function ()
        {
            if(rawFile.readyState === 4)
            {
                if(rawFile.status === 200 || rawFile.status == 0)
                {
                    var allText = rawFile.responseText;
                    //alert(allText);
                    //return parseInt(allText);
                }
            }
        }
        rawFile.send(null);
        return rawFile.responseText;
    }    


    function TouchMove(e){
        mouse[0]=e.touches[0].clientX;
        mouse[1]=e.touches[0].clientY;
    }    

    function MousePos(e){
        mouse[0]=e.clientX;
        mouse[1]=e.clientY;
        //console.log(mouse);
    } 
    
    function loadImage(src) {
        try{
            var img = new Image();
            img.src = src;
            img.isReady = false;
            img.onload = function() {
                img.isReady = true;
            };
            return img;
        }
        catch(err){
            console.log("Error loading Image");
        }
    }

    function get_all_animations(){
        var s=new String();
        var adressMenu="images/Intro/";
        var adressIdle="images/Idle/";
        var adressGoodAttacks="images/GoodAttacks/";
        var adressGoodDefense="images/GoodDefense/";
        var adressGoodEvolve="images/GoodEvolve/";
        var adressEvilAttacks="images/EvilAttacks/";
        var adressEvilDefense="images/EvilDefense/";
        var adressEvilEvolve="images/EvilEvolve/";
        
        //Get Intro Images
        var number_of_folders=parseInt(readTextFile(adressMenu+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressMenu+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            Intro.push(animation_images);
        }
        //Get Idle Images
        var number_of_folders=parseInt(readTextFile(adressIdle+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressIdle+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            Idle.push(animation_images);
        }
        //Get GoodAttacks Images
        var number_of_folders=parseInt(readTextFile(adressGoodAttacks+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressGoodAttacks+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            GoodAttacks.push(animation_images);
        }
         //Get EvilDefense Images
        var number_of_folders=parseInt(readTextFile(adressEvilDefense+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressEvilDefense+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            EvilDefense.push(animation_images);
        }
        //Get EvilAttacks Images
        var number_of_folders=parseInt(readTextFile(adressEvilAttacks+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressEvilAttacks+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            EvilAttacks.push(animation_images);
        }
        //Get GoodDefense Images
        var number_of_folders=parseInt(readTextFile(adressGoodDefense+"/Index.txt"));
        console.log("Numeber:"+number_of_folders);
        var animation_images=[];
        var finalAdress;
        for(j=0;j<number_of_folders;j++){
            almost_final_adress=adressGoodDefense+j+"/";
            number_of_images=parseInt(readTextFile(almost_final_adress+"Index.txt"));
            for(i=0;i<number_of_images;i++){
                finalAdress=almost_final_adress+i+".jpg";
                try{animation_images[i]=loadImage(finalAdress);}
                catch(err){console.log("Error Loading Image");haveFiles=false;}
            }
            GoodDefense.push(animation_images);
        }
    }    
   
    function Draw(images_array){
            dt = 1E-3 * (new Date().getTime() - startTime);
            startTime = new Date().getTime();
            time += dt%10000;
        
            var index=Math.floor((time*60))%(images_array.length);
            //console.log(index);
            var frame = images_array[index];
            if(frame.isReady ){
                context.drawImage(frame,0,0,window.innerWidth,window.innerHeight); 
            }
            
    }
    
    
    var image_index=0;
    function Main(){
         canvas.width=window.innerWidth;
        canvas.height=window.innerHeight;
        //image=Intro[0][i];
        //context.drawImage(Intro[0][image_index],0,0,window.innerWidth,window.innerHeight);
        //image_index=(image_index+1)%Intro[0].length;
        Draw(actualAnimationRunning);
        
        window.requestAnimationFrame(Main);
    }
    
    //Main________________________________________
   
    get_all_animations();
    startTime = new Date().getTime();
    actualAnimationRunning=Intro[0];
    menu=new Menu();
    
    window.requestAnimationFrame(Main);
    //setInterval(Main,10);    
</script>
</html>